

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Appendix: Multiplication and Convolution in Different Domains &#8212; Case Studies in Neural Data Analysis</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/custom.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="canonical" href="https://mark-kramer.github.io/Case-Studies-Python/appendix.html" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />


    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<!-- Put requirejs at the end so it's always after bootstrap -->
<!-- TODO: remove this once https://github.com/pandas-dev/pydata-sphinx-theme/pull/149 is merged -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>


<!-- Opengraph tags -->
<meta property="og:url"         content="https://mark-kramer.github.io/Case-Studies-Python/appendix.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Appendix: Multiplication and Convolution in Different Domains" />
<meta property="og:description" content="Appendix: Multiplication and Convolution in Different Domains  # Import numpy and matplotlib packages import numpy as np import matplotlib.pyplot as plt  We sta" />
<meta property="og:image"       content="https://mark-kramer.github.io/Case-Studies-Python/_static/logo.png" />

<meta name="twitter:card" content="summary">


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          

<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Case Studies in Neural Data Analysis</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="intro.html">Case-Studies-Python</a>
  </li>
  <li class="">
    <a href="introduction-to-python.html">Python for the practicing neuroscientist</a>
  </li>
  <li class="">
    <a href="the-event-related-potential.html">The Event-Related Potential for the practicing neuroscientist</a>
  </li>
  <li class="">
    <a href="the-power-spectrum-part-1.html">Analysis of rhythmic activity for the practicing neuroscientist</a>
  </li>
  <li class="">
    <a href="ecog-rhythms.html">The Power Spectrum (Part 2)</a>
  </li>
  <li class="">
    <a href="the-cross-covariance-and-coherence.html">Analysis of coupled rhythms for the practicing neuroscientist</a>
  </li>
  <li class="">
    <a href="filtering-scalp-eeg.html">Application of Filtering to Scalp EEG Data</a>
  </li>
  <li class="">
    <a href="cross-frequency-coupling.html">Cross-frequency coupling for the practicing neuroscientist</a>
  </li>
  <li class="">
    <a href="basic-visualizations-and-descriptive-statistics-of-spike-train-data.html">Basic Visualizations and Descriptive Statistics of Spike Train Data</a>
  </li>
  <li class="">
    <a href="point-process-glms.html">Modeling Place Fields with Point Process Generalized Linear Models</a>
  </li>
  <li class="">
    <a href="spiking-rhythms.html">Analysis of Rhythmic Spiking in the Subthalamic Nucleus During a Movement Task</a>
  </li>
  <li class="">
    <a href="spike-field-coherence.html">Analysis of spike-field cohernece for the practicing neuroscientist <a id="top"></a></a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Appendices</p>
</li>
  <li class="">
    <a href="backprop.html">Backpropagation</a>
  </li>
  <li class="">
    <a href="HH.html">The Hodgkin-Huxley model</a>
  </li>
  <li class="">
    <a href="LIF.html">The integrate and fire neuron</a>
  </li>
  <li class="">
    <a href="perceptron.html">Training a Perceptron</a>
  </li>
</ul>
</nav>
<p class="navbar_footer"></p>
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="_sources/appendix.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.ipynb</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
            <div class="dropdown-buttons">
                
                <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/appendix.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip" data-placement="left"><img class="binder-button-logo" src="_static/images/logo_binder.svg" alt="Interact on binder">Binder</button></a>
                
                
                
            </div>
        </div>
        

        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 col-xxl-7 pl-md-3 pr-md-0">
        
              <div>
                
  <p><a id="top"></a></p>
<div class="section" id="appendix-multiplication-and-convolution-in-different-domains">
<h1>Appendix: Multiplication and Convolution in Different Domains<a class="headerlink" href="#appendix-multiplication-and-convolution-in-different-domains" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import numpy and matplotlib packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>We stated in this module the important fact that multiplication in the time domain is equivalent to convolution in the frequency domain. Mathematically, we may express this relation as,</p>
<div class="math notranslate nohighlight">
\[
FT[xw] = FT[x]\star FT[w]
\tag{1}
\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(w\)</span> are two time series, <span class="math notranslate nohighlight">\(FT[x]\)</span> is the Fourier transform of <span class="math notranslate nohighlight">\(x\)</span>, and <span class="math notranslate nohighlight">\(X \star Y\)</span> indicates the convolution of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>,</p>
<div class="math notranslate nohighlight">
\[X \star Y[\beta] = \int_{-\infty}^{\infty}X[b]Y[\beta - b]db.\]</div>
<p>The convolution of two functions (with arguments <span class="math notranslate nohighlight">\(b\)</span> in this formula) is itself a function of the same argument (with symbol <span class="math notranslate nohighlight">\(\beta\)</span> in this formula). Equation (1) states that the Fourier transform of the element-by-element product of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(w\)</span> equals the convolution of the Fourier transform of <span class="math notranslate nohighlight">\(x\)</span> and the Fourier transform of <span class="math notranslate nohighlight">\(w\)</span>. We consider here an equivalent, alternative statement: that convolution in the time domain is equivalent to multiplication in the frequency domain. Mathematically,</p>
<div class="math notranslate nohighlight">
\[
FT[x \star w] = FT[x]FT[w].
\]</div>
<p>This equation states that the Fourier transform of the convolution of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(w\)</span> equals the product of the Fourier transform of <span class="math notranslate nohighlight">\(x\)</span> and the Fourier transform of <span class="math notranslate nohighlight">\(w\)</span>. To prove this relation, let’s consider the Fourier transform of the convolution of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(w\)</span>. We use the following expression for the continuous-time Fourier transform,</p>
<div class="math notranslate nohighlight">
\[
FT(x \star w[\tau]) = \int_{-\infty}^{\infty}\big(x\star w[\tau]\big)e^{-2 \pi i f \tau}d\tau,
\]</div>
<p>where the notation <span class="math notranslate nohighlight">\([\tau]\)</span> indicates that the convolution <span class="math notranslate nohighlight">\((x\star w)\)</span> is a function of time <span class="math notranslate nohighlight">\(\tau\)</span>. Now, let’s substitute the definition of convolution into this expression and simiplify using an introduction of a second exponential expression,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
FT(x \star w[\tau]) = &amp; 
\int_{-\infty}^{\infty}
\bigg( \int_{-\infty}^\infty x[t]w[\tau-t]dt \bigg)
e^{-2\pi i f \tau} 
d\tau \\
%
= &amp; \int_{-\infty}^{\infty} 
\int_{-\infty}^\infty 
x[t]w[\tau-t]dt\ 
e^{-2\pi i f (\tau - t)} 
e^{-2\pi i f t} 
d\tau \\
%
= &amp; \int_{-\infty}^{\infty} \int_{-\infty}^\infty 
\big( x[t] e^{-2\pi i f t} \big)
\big( w[\tau - t] e^{-2\pi i f (\tau - t)}\big)
dt\ d\tau.\\
\end{align}
\end{split}\]</div>
<p>Setting <span class="math notranslate nohighlight">\(T \equiv \tau - t\)</span>, we find</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
FT(x \star w[\tau]) = &amp; 
\int_{-\infty}^{\infty} \int_{-\infty}^\infty 
\big( x[t] e^{-2\pi i f t} dt \big)
\big( w[T] e^{-2\pi i f (T)} dT \big) \\
%
= &amp; \bigg( \int_{-\infty}^{\infty}x[t] e^{-2\pi i f t} dt \bigg)
\bigg(\int_{-\infty}^{\infty} w[T] e^{-2\pi i f (T)} dT \bigg) \\
%
= &amp; FT[x]FT[w]
%
\end{align}
\end{split}\]</div>
<p>and therefore conclude that the Fourier transform of the convolution of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(w\)</span> equals the element-by-element product of their Fourier transforms.</p>
<p>We may compute a simple example to illustrate this relation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>                            <span class="c1"># Define a simple signal x,</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>               <span class="c1"># ... and another simple signal w.</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>              <span class="c1"># Take the FT of the convolution,</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">w</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]))</span> <span class="o">*</span> \
    <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]))</span>      <span class="c1"># ... and the product of the FTs</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">real</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>        <span class="c1"># Plot the difference</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">imag</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;imaginary&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Difference between Fourier transform of convolution </span><span class="se">\n</span><span class="s1"> and element-wise product of Fourier transforms</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/appendix_7_0.png" src="_images/appendix_7_0.png" />
</div>
</div>
<p>In the first two lines, we define two simple signals; each consists of only four elements, which is enough to illustrate the relation. In the third line, we first compute the convolution of <span class="math notranslate nohighlight">\(w\)</span> and <span class="math notranslate nohighlight">\(x\)</span>, and then the Fourier transform. In the last line, we compute the Fourier transform of each variable, and then their element-by-element product. Notice that we zero-pad both variables before computing the Fourier transform in the last line. We do so to avoid computing circular correlations between the variables (i.e., wrapping around one variable when comparing it to another). Also, we make the lengths of variables <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> the same. Evaluating the statement, we find the difference between <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> to be on the order of <span class="math notranslate nohighlight">\(10^{-15}\)</span>, which is very close to zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;../../assets/custom/custom.css&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.left {
    margin-left: 0px;
}
.warning {
    color: #a94442;
    background-color: #f2dede;
    border-color: #ebccd1;
    border-radius: 5px;
    padding: 12px;
    margin-bottom: 12px;
    margin-top: 12px;
}
.math-note {
    color: #3c763d;
    background-color: #dff0d8;
    border-color: #d6e9c6;
    /*border: 1px solid;*/
    border-radius: 5px;
    padding: 12px;
    margin-bottom: 12px;
    margin-top: 12px;
}
.python-note {
    color: #8a6d3b;
    background-color: #fcf8e3;
    border-color: #faebcc;
    /*border: 1px solid;*/
    border-radius: 5px;
    padding: 12px;
    margin-bottom: 12px;
    margin-top: 12px;
}
.question {
    display: block;
    color: #31708f;
    background-color: #d9edf7;
    border-color: #bce8f1;
    /*border: 1px solid;*/
    padding: 12px;
    margin-bottom: 12px;
    margin-top: 12px;
    border-radius: 5px;
}
.question p, .math-note p, .python-note p, .warning p {
    /*margin-top: 1em;*/
    margin-top: 0;
    margin-bottom: 0;
}
.question * + p, .math-note * + p, .python-note * + p, .warning * + p {
    /*margin-bottom: 0;*/
    margin-top: 1em;
}
.output_area img, .output_area iframe, .output_html iframe {
    display: block;
    margin-left: auto;
    margin-right: auto;
}
.inner_cell img {
    max-width:90%;
    /*max-width:700px;*/
    /*max-height: 90%;*/
}
.fig, .thumb, .sup {
    position: inherit;
    color: #57b733;
    cursor: help;
    text-decoration: underline dotted;
    max-width: 700px;
}   
.thumb img{ 
    max-width: 400px;
}
.sup {
    top: -.5em;
    font-size: 75%;
    vertical-align: super;
}
.fig img, .sup img, .thumb img { 
    /*width: 100%;*/
    max-width: 90%;
    max-height: 50vh;
    border:1px solid #000;
    visibility: hidden;
    background-color: black;
    border-radius: 6px;
    padding: 5px 5px;
    position: absolute;
    transition: 5ms visibility;
    z-index: 99;
    left: 50%;
    transform: translate(-50%, -50%);
}
.fig:hover, .fig:hover img, .sup:hover img, .thumb:hover, .thumb:hover img { 
    visibility:visible;
    transition-delay: 500ms;
}
</style>
</div></div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2020.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.<br/>
    </p>
  </div>
</footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>
---
redirect_from:
  - "/a04/perceptron"
interact_link: content/A04/perceptron.ipynb
kernel_name: python3
kernel_path: content/A04
has_widgets: false
title: |-
  Training a Perceptron
pagenum: 14
prev_page:
  url: /A03/LIF.html
next_page:
  url: 
suffix: .ipynb
search: p perceptron alert y x above line point div lets function input well below inputs step error code class block info q weights ask its output guess compute weight return consider known answer plane our set does w value slope intercept choose br wb new training simple model train example sense need answers bias wx wy perceptrons update module classify discussion please python comment comments doing makes good always try part examine returns take theta wed procedure given e should where desiredoutput last continued determine coordinate learning constant repetitions hand whether construct models start implementing seeing behaves outline steps follows

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Training a Perceptron</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Training-a-Perceptron">Training a Perceptron<a class="anchor-link" href="#Training-a-Perceptron"> </a></h1><p>In this module, we will construct simple perceptron models. We'll start by implementing a perceptron model, and seeing how it behaves. We'll then outline the steps to train a perceptron to classify a point as above or below a line.</p>
<p>This discussion follows the excellent example and discussion at <a href="https://natureofcode.com/book/chapter-10-neural-networks/">The Nature of Code</a>. Please see that reference for additional details, and a more sophisticated coding strategy (using Classes in Python).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preliminaries">Preliminaries<a class="anchor-link" href="#Preliminaries"> </a></h2><p>Text preceded by a <code>#</code> indicates a 'comment'.  I will use comments to explain what we're doing and to ask you questions.  Also, comments are useful in your own code to note what you've done (so it makes sense when you return to the code in the future).  It's a good habit to <em>always</em> comment your code.  I'll try to set a good example, but won't always . . .</p>
<p>Before beginning, let's load in the Python packages we'll need:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-1:---A-simple-perceptron-model.">Part 1:   A simple perceptron model.<a class="anchor-link" href="#Part-1:---A-simple-perceptron-model."> </a></h2><p>Let's examine a simple perceptron that accepts inputs, processes those inputs, and returns an output. To do so, please consider this function:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">my_perceptron</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="c1"># Define the activity of the perceptron, x.</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">input1</span><span class="o">*</span><span class="n">w1</span> <span class="o">+</span> <span class="n">input2</span><span class="o">*</span><span class="n">w2</span> <span class="o">+</span> <span class="n">theta</span>
    
    <span class="c1"># Apply a binary threshold,</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">

**Q:** How many inputs does the function take?  How many outputs does it return?<p></p>

**Q:** Looking at this code, could you sketch a model of this perceptron?<p></p>

**Q:** Apply this function to different sets of inputs. Consider,<p></p>

  `input1 = 1, input2 = 0, w1 = 0.5, w2 = -0.5, theta = 0`<p></p>

  and<p></p>

  `input1 = 1, input2 = 0, w1 = 0.5, w2 = -0.5, theta = -1`<p></p>

  What do you find?
</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-2.--Build-a-perceptron-classifier.">Part 2.  Build a perceptron classifier.<a class="anchor-link" href="#Part-2.--Build-a-perceptron-classifier."> </a></h2><p>We'd like to create a method to train a perceptron to classify a point (x,y) as above or below a line. Let's implement this training procedure.</p>
<h3 id="Step-1.-Provide-perceptron-with-inputs-and-known-answer.">Step 1. Provide perceptron with inputs and known answer.<a class="anchor-link" href="#Step-1.-Provide-perceptron-with-inputs-and-known-answer."> </a></h3><p>First, let's make a function that computes a line, and determines if 
  a given <code>y</code> value is above or below the line. We'll use this function
  to return the correct ("known") answer. Having known answers is
  important for training the perceptron. We'll use the known answers to
  tell the when it's right or wrong (i.e., when the perceptron makes an
  error).</p>
<p>Let's define the function (<code>known_answer</code>) should take four inputs:</p>
<ul>
<li><code>slope</code></li>
<li><code>intercept</code></li>
<li><code>x</code></li>
<li><code>y</code></li>
</ul>
<p>where the (x,y) value is a point we choose on the plane. The function
  should return one output:</p>
<ul>
<li><code>desired_output</code></li>
</ul>
<p>where,</p>
<p><code>desired_output = 1</code>, if the <code>y</code> value (the last input) is above the line,</p>
<p><code>desired_putput = 0</code>, if the <code>y</code> value (the last input) is below the line.</p>
<p>Consider the function below:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">known_answer</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>

  <span class="n">yline</span> <span class="o">=</span> <span class="n">slope</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>  <span class="c1"># Compute y-value on the line.</span>
  <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">yline</span><span class="p">:</span>                <span class="c1"># If the input y value is above the line,</span>
      <span class="k">return</span> <span class="mi">1</span>                 <span class="c1"># ... indicate this with output = 1;</span>
  <span class="k">else</span><span class="p">:</span>                        <span class="c1"># Otherwise, the input y is below the line,</span>
      <span class="k">return</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">

**Q:** Consider the (x,y) point,<p></p>

`x,y = 0.7,3` <p></p>

and the line with slope and intercept, <p></p>

`slope = 2` <br></br>
`intercept = 1`<p></p>

Is the (x,y) point above or below the line?<p></p>
<br>


**A:** To answer this, let's ask our function,
</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span><span class="mi">3</span>
<span class="n">slope</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">correct_answer</span> <span class="o">=</span> <span class="n">known_answer</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correct_answer</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">

**A (Continued):** We find a `correct_answer` of 1.<p></p>

So, the point `(x,y)=(0.7,3)` is above the line with slope 2 and intercept 1.
</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Step-2:-Ask-perceptron-to-guess-an-answer.">Step 2: Ask perceptron to guess an answer.<a class="anchor-link" href="#Step-2:-Ask-perceptron-to-guess-an-answer."> </a></h3><p>Our next step is to compare our desired output (computed in Step 1) to
 the output guessed by the perceptron. To do so, we'll need to compute
 the <em>feedforward</em> solution for the perceptron (i.e., given the inputs
 and bias, determine the perceptron output). Let's do so,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wx</span><span class="p">,</span> <span class="n">wy</span><span class="p">,</span> <span class="n">wb</span><span class="p">):</span>

  <span class="c1"># Fix the bias.</span>
  <span class="n">bias</span> <span class="o">=</span> <span class="mi">1</span>

  <span class="c1"># Define the activity of the neuron, activity.</span>
  <span class="n">activity</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">wx</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">wy</span> <span class="o">+</span> <span class="n">wb</span><span class="o">*</span><span class="n">bias</span>
  
  <span class="c1"># Apply the binary threshold,</span>
  <span class="k">if</span> <span class="n">activity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">1</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This function takes five inputs:</p>
<ul>
<li><code>x</code>  = the x coordinate of the point we choose in the plane.</li>
<li><code>y</code>  = the y coordinate of the point we choose in the plane.</li>
<li><code>wx</code> = the weight of x input.</li>
<li><code>wy</code> = the weight of y input.</li>
<li><code>wb</code> = the weight of the bias.</li>
</ul>
<p>And this function returns one output:</p>
<ul>
<li>the perceptron's guess, is the point above (=1) or below (=0) the line.</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">
**Q:**  Again consider the (x,y) point, <p></p>

`x,y = 0.7,3` <p></p>

and set initial values for the perceptron weights. Let's just set these all to 0.5;  our goal in the rest of this module will be to train the perceptron by adjusting these weights.  But for now,<p></p>

`wx,wy,wb = 0.5` <p></p>

Then, ask the perceptron for it's guess for it's guess, is the point above or below the line?<p></p>

</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span><span class="mi">3</span>
<span class="n">wx</span><span class="p">,</span><span class="n">wy</span><span class="p">,</span><span class="n">wb</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
<span class="n">perceptron_guess</span> <span class="o">=</span> <span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wx</span><span class="p">,</span> <span class="n">wy</span><span class="p">,</span> <span class="n">wb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">perceptron_guess</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">

**A (Continued):** We find a `peceptron_guess` of 1.<br>
<p>

So, the perceptron guesses that the point `(x,y)=(0.7,3)` is above the line.

</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Step-3:-Compute-the-error.">Step 3: Compute the error.<a class="anchor-link" href="#Step-3:-Compute-the-error."> </a></h3><p>We've now answered the question "<em>Is the (x,y) point above the line?</em>" in 
 two ways:</p>
<ul>
<li>the known answer, and </li>
<li>the perceptron's guess.</li>
</ul>
<p>Let's compute the error as the difference between these two answers:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">error</span> <span class="o">=</span> <span class="n">correct_answer</span> <span class="o">-</span> <span class="n">perceptron_guess</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">
**Q:**  What do you find for the `error`? Does it make sense?
</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Step-4:-Adjust-all-weights-according-to-the-error.">Step 4: Adjust all weights according to the error.<a class="anchor-link" href="#Step-4:-Adjust-all-weights-according-to-the-error."> </a></h3><p>To update the weights, we'll use the expression,</p>
<p><code>new weight = weight + error * input * learning constant</code></p>
<p>We need to compute this for each weight <code>(wx, wy, wb)</code>.</p>
<p>First, let's set the learning constant,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learning_constant</span> <span class="o">=</span> <span class="mf">0.01</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we can compute the new weights,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wx</span> <span class="o">=</span> <span class="n">wx</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="n">x</span>   <span class="o">*</span><span class="n">learning_constant</span>
<span class="n">wy</span> <span class="o">=</span> <span class="n">wy</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="n">y</span>   <span class="o">*</span><span class="n">learning_constant</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">wb</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="mi">1</span>   <span class="o">*</span><span class="n">learning_constant</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that, in the update to <code>wb</code> we use the fact that the bias equals 1.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">
**Q:**  What do you find for the new weights? Does it make sense?
</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Step-5:-Return-to-Step-1-and-repeat-...">Step 5: Return to Step 1 and repeat ...<a class="anchor-link" href="#Step-5:-Return-to-Step-1-and-repeat-..."> </a></h3><p>We could try to compute these repetitions by hand, for example by repeating
 the cells above. To do so, we'd choose a new point in the (x,y) plane,
 determine whether it's above the line 2x+1, ask the perceptron to guess
 whether it's above the line, then use the error to update the
 perceptron's weights.</p>
<p>But we want to evaluate this procedure 2000 times. Doing so by
 hand would be a total pain, and highly error prone. Instead, let's
 ask the computer to do the boring work of multiple repetitions. To do so,
 let's collect the code above, and examine 2000 (x,y) points chosen
 randomly in the plane. We'll wrap our code above inside a for-loop to
 make this efficient,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slope</span>     <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>                      <span class="c1"># Define the line with slope, </span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>                      <span class="c1"># ... and intercept.</span>

<span class="n">wx</span><span class="p">,</span><span class="n">wy</span><span class="p">,</span><span class="n">wz</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="p">[</span><span class="mf">0.5</span><span class="p">];</span>                 <span class="c1"># Choose initial values for the perceptron&#39;s weights</span>

<span class="n">learning_constant</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>           <span class="c1"># And, set the learning constant.</span>

<span class="n">estimated_slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>    <span class="c1"># Variables to hold the perceptron estimates.</span>
<span class="n">estimated_intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>           <span class="c1"># For 2000 iteractions,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>         <span class="c1"># Choose a random (x,y) point in the plane</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
                                    <span class="c1"># Step 1: Calculate known answer.</span>
    <span class="n">correct_answer</span> <span class="o">=</span> <span class="n">known_answer</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
    
                                    <span class="c1"># Step 2. Ask perceptron to guess an answer.</span>
    <span class="n">perceptron_guess</span> <span class="o">=</span> <span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wx</span><span class="p">,</span> <span class="n">wy</span><span class="p">,</span> <span class="n">wb</span><span class="p">);</span>
    
                                    <span class="c1"># Step 3. Compute the error.</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">correct_answer</span> <span class="o">-</span> <span class="n">perceptron_guess</span><span class="p">;</span>
    
                                    <span class="c1"># Step 4. Adjust weights according to error.</span>
    <span class="n">wx</span> <span class="o">=</span> <span class="n">wx</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">learning_constant</span><span class="p">;</span>
    <span class="n">wy</span> <span class="o">=</span> <span class="n">wy</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">learning_constant</span><span class="p">;</span>
    <span class="n">wb</span> <span class="o">=</span> <span class="n">wb</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="mi">1</span><span class="o">*</span><span class="n">learning_constant</span><span class="p">;</span>
     
    <span class="n">estimated_slope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">wx</span><span class="o">/</span><span class="n">wy</span><span class="p">;</span>    <span class="c1"># Compute estimated slope from perceptron.</span>
    <span class="n">estimated_intercept</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">wb</span><span class="o">/</span><span class="n">wy</span><span class="p">;</span><span class="c1"># Compute estimated intercept from perceptron.</span>

<span class="c1"># Display the results! ------------------------------------------------------------------------</span>
<span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span>                  <span class="c1"># For a range of x-values,</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">slope</span><span class="o">*</span><span class="n">x_range</span><span class="o">+</span><span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>    <span class="c1"># ... plot the true line,</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>                       <span class="c1"># ... and plot some intermediate perceptron guess</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">estimated_slope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">x_range</span><span class="o">+</span><span class="n">estimated_intercept</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
                                                  <span class="c1"># ... and plot the last perceptron guess</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">estimated_slope</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x_range</span><span class="o">+</span><span class="n">estimated_intercept</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Known answer (black), Perceptron final guess (blue)&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/A04/perceptron_27_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

 


    </main>
    
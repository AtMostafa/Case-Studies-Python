---
redirect_from:
  - "/a02/hh"
interact_link: content/A02/HH.ipynb
kernel_name: python3
kernel_path: content/A02
has_widgets: false
title: |-
  Hodgkin Huxley Model
pagenum: 13
prev_page:
  url: /A01/backprop.html
next_page:
  url: /A03/LIF.html
suffix: .ipynb
search: alert div lets model current plot spike hh part dynamics class block info q well input code examine variables simulation evolve during conductances v m h n python neuron start gating t voltage variable single figure subplot simulate focus useful ms axis our three x hodgkin huxley define inputs outputs notice br hint high gates new subfigure same describe module here its heres details lecture prof gerstner detailed klewel com conferences epfl neural networks index php talkid need functions repository case identify five activation na plotting focusing small weve function resulting vs observation value point repeated row help move next

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Hodgkin Huxley Model</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="The-Hodgkin-Huxley-model">The Hodgkin-Huxley model<a class="anchor-link" href="#The-Hodgkin-Huxley-model"> </a></h1><p>In this module we will use Python to simulate the Hodgkin-Huxley (HH) neuron model.  This model is arguably the <em>most</em> important computational model in neuroscience.  We'll focus here on simulating this model and understanding its pieces.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Background-information-about-the-HH-model">Background information about the HH model<a class="anchor-link" href="#Background-information-about-the-HH-model"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's a video that describes some of the biophysical details of the HH model:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.lib.display</span> <span class="kn">import</span> <span class="n">VimeoVideo</span>
<span class="n">VimeoVideo</span><span class="p">(</span><span class="s1">&#39;140084450&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

<iframe
    width="400"
    height="300"
    src="https://player.vimeo.com/video/140084450"
    frameborder="0"
    allowfullscreen
></iframe>

</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here are some additional usual videos and references:</p>
<ul>
<li><p><a href="http://klewel.com/conferences/epfl-neural-networks/index.php?talkID=4">Lecture by Prof. Gerstner, <em>Detailed Neuron Model (a)</em></a></p>
</li>
<li><p><a href="http://klewel.com/conferences/epfl-neural-networks/index.php?talkID=5">Lecture by Prof. Gerstner, <em>Detailed Neuron Model (b)</em></a></p>
</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preliminaries">Preliminaries<a class="anchor-link" href="#Preliminaries"> </a></h2><p>Before beginning, let's load in the Python packages we'll need:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="o">%</span><span class="k">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Using matplotlib backend: MacOSX
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In addition, let's import the functions we'll need to simulate the HH model, which are available on this repository:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">HH_functions</span> <span class="kn">import</span> <span class="n">HH</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-1:---The-Hodgkin-Huxley-(HH)-equation-code.">Part 1:   The Hodgkin-Huxley (HH) equation code.<a class="anchor-link" href="#Part-1:---The-Hodgkin-Huxley-(HH)-equation-code."> </a></h2><p>To start, let's examine the code for the HH model. We can do so in (at least) two ways.</p>
<ul>
<li>Go to the Case Studies repository, and examine the Python file
<code>HH_functions.py</code></li>
<li>Examine the code inline with <code>inspect</code></li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">inspect</span>
<span class="n">inspect</span><span class="o">.</span><span class="n">getsourcelines</span><span class="p">(</span><span class="n">HH</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([&#39;def HH(I0,T0):\n&#39;,
  &#39;    dt = 0.01;\n&#39;,
  &#39;    T  = math.ceil(T0/dt)  # [ms]\n&#39;,
  &#39;    gNa0 = 120   # [mS/cm^2]\n&#39;,
  &#39;    ENa  = 115;  # [mV]\n&#39;,
  &#39;    gK0  = 36;   # [mS/cm^2]\n&#39;,
  &#39;    EK   = -12;  # [mV]\n&#39;,
  &#39;    gL0  = 0.3;  # [mS/cm^2]\n&#39;,
  &#39;    EL   = 10.6; # [mV]\n&#39;,
  &#39;\n&#39;,
  &#39;    t = np.arange(0,T)*dt\n&#39;,
  &#39;    V = np.zeros([T,1])\n&#39;,
  &#39;    m = np.zeros([T,1])\n&#39;,
  &#39;    h = np.zeros([T,1])\n&#39;,
  &#39;    n = np.zeros([T,1])\n&#39;,
  &#39;\n&#39;,
  &#39;    V[0]=-70.0\n&#39;,
  &#39;    m[0]=0.05\n&#39;,
  &#39;    h[0]=0.54\n&#39;,
  &#39;    n[0]=0.34\n&#39;,
  &#39;\n&#39;,
  &#39;    for i in range(0,T-1):\n&#39;,
  &#39;        V[i+1] = V[i] + dt*(gNa0*m[i]**3*h[i]*(ENa-(V[i]+65)) + gK0*n[i]**4*(EK-(V[i]+65)) + gL0*(EL-(V[i]+65)) + I0);\n&#39;,
  &#39;        m[i+1] = m[i] + dt*(alphaM(V[i])*(1-m[i]) - betaM(V[i])*m[i]);\n&#39;,
  &#39;        h[i+1] = h[i] + dt*(alphaH(V[i])*(1-h[i]) - betaH(V[i])*h[i]);\n&#39;,
  &#39;        n[i+1] = n[i] + dt*(alphaN(V[i])*(1-n[i]) - betaN(V[i])*n[i]);\n&#39;,
  &#39;    return V,m,h,n,t\n&#39;],
 22)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">

**Q:**  Examine this code.  Can you make sense of it?  Can you identify the
gating variables?  The rate functions?  The equations that define the dynamics?
We'll answer these questions in this in module, but try so on your own first.

</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Whenever examining code, it's useful to consider the <em>inputs</em> to the code, and the <em>outputs</em> produced by the code.  There are two inputs to <code>HH0</code>:</p>
<ul>
<li><code>I0</code> = the current we inject to the neuron.</li>
<li><code>T0</code> = the total time of the simulation in [ms].</li>
</ul>
<p>And there are five outputs:</p>
<ul>
<li><code>V</code> = the voltage of neuron.</li>
<li><code>m</code> = activation variable for Na-current.</li>
<li><code>h</code> = inactivation variable for Na-current.</li>
<li><code>n</code> = activation variable for K-current.</li>
<li><code>t</code> = the time axis of the simulation (useful for plotting).</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-2:--At-low-input-current-(I0),-examine-the-HH-dynamics.">Part 2:  At low input current (<code>I0</code>), examine the HH dynamics.<a class="anchor-link" href="#Part-2:--At-low-input-current-(I0),-examine-the-HH-dynamics."> </a></h2><p>To understand how the HH model works, we'll start by focusing on the
  case when <code>I0</code> is small. Let's fix the input current to zero,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">I0</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>and let's simulate the model for 100 ms,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">T0</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've now defined both inputs to the <code>HH</code> function, and can execute it, as follows,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">V</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">HH</span><span class="p">(</span><span class="n">I0</span><span class="p">,</span><span class="n">T0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that the function returns five outputs, which we assign to the variables <code>V</code>, <code>m</code>, <code>h</code>, <code>n</code>, and <code>t</code>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">

**Q:**  What are the dynamics of the voltage (variable `V`) resulting
from this simulation?<br>
HINT:  Plot `V` vs `t`.

</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">

**Q:**   What are the dynamics of the gating variables (`m`, `h`, `n`)
resulting from this simulation?<br>
HINT:  Plot them!

</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">

**Q:**  What are the final values (after the 100 ms of simulation) of
`V`, `m`, `h`, and `n`?

</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Observation-for-Part-2">Observation for Part 2<a class="anchor-link" href="#Observation-for-Part-2"> </a></h3><p>At this value of input current (<code>I0=0</code>), the model dynamics
approach a "fixed point", whose location we can identify as a point in four dimensional space.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-3:--At-high-input-current-(I0),-examine-the-HH-dynamics-of-a-spike.">Part 3:  At high input current (<code>I0</code>), examine the HH dynamics of a spike.<a class="anchor-link" href="#Part-3:--At-high-input-current-(I0),-examine-the-HH-dynamics-of-a-spike."> </a></h2><p>Let's now increase the input current to the HH model and get this model
  to generate repeated spiking activity.  To do so, let's set,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">I0</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now simulate this model,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">V</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">HH</span><span class="p">(</span><span class="n">I0</span><span class="p">,</span><span class="n">T0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">
**Q:**  What happens to the dynamics?<br>
HINT:  Plot V vs t.
</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Observation-for-Part-3">Observation for Part 3<a class="anchor-link" href="#Observation-for-Part-3"> </a></h3><p>You should have found that, at this value of input current, the model
  <strong>generates repeated spikes</strong>.</p>
<p>Let's now explore how the combined gates
  and dynamics evolve.  To do so, let's start by focusing our plot on a
  single spike.  As a first step, we'll make a new figure with a seperate subfigure to plot
  the voltage,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x114230c50&gt;</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This <code>subplot</code> command divides the figure into two rows, and one column, and tells Python we'll start in the first row. See Python Help for more details:</p>
<p><code>plt.subplot??</code></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, let's plot the voltage, and choose the time axis to focus on a single spike,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">42</span><span class="p">,</span> <span class="mi">56</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;V [mV]&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Okay, we've now plotted the voltage dynamics for a single spike (and
  colored the curve black).  Let's now plot the three gating variables.
  To do so, we'll move to the next subplot,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(the next row in the figure).  Within this subplot, let's start by displaying the gating variable <code>m</code> over the same x-limits,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">42</span><span class="p">,</span> <span class="mi">56</span><span class="p">]);</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that, in the call to <code>plot</code> we included the input <code>label</code>. This will be useful when we create a legend ... <br><br>Within this subplot, we can also simultaneously show the gating
  variables <code>h</code> and <code>n</code>,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Label the x-axis,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [ms]&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, let's add a legend to help us keep track of the different curves,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">
**Q:** Using the figure you created above, describe how the gates swing open and closed during a spike.
</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ASIDE:">ASIDE:<a class="anchor-link" href="#ASIDE:"> </a></h3><p>Here's a nice plotting trick, to link the x-axes of our two subfigures.  Linking the axes is useful so that, when we zoom or move one subfigure, the other subfigure will match the x-axis.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">);</span>                 <span class="c1"># Define axis for 1st subplot,</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">);</span>     <span class="c1"># ... and link axis of 2nd subplot to the 1st.</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>                       <span class="c1"># Plot the voltage in the first subplot,</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">42</span><span class="p">,</span> <span class="mi">56</span><span class="p">]);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>            <span class="c1"># ... and the gating variables in the other subplot.</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [ms]&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, in the figure, you may use the pan/zoom tool to adjust the linked subplots.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-4:--At-high-input-current-(I0),-describe-the-dynamics-of-the-conductances.">Part 4:  At high input current (<code>I0</code>), describe the dynamics of the conductances.<a class="anchor-link" href="#Part-4:--At-high-input-current-(I0),-describe-the-dynamics-of-the-conductances."> </a></h2><p>In Part 3, we explored how the three gates <code>m</code>, <code>h</code>, and <code>n</code> evolve
  during a spike.  By combining these terms, we can visualize how the
  <em>conductances</em> evolve during a spike.  To do so, let's stick with the
  simulation results we generated in Part 3, and focus our plot on a
  single spike,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>                <span class="c1"># Make a subplot,</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>                   <span class="c1">#... and plot the voltage,</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">42</span><span class="p">,</span> <span class="mi">56</span><span class="p">])</span>                  <span class="c1">#... focused on a single spike,</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;V [mV]&#39;</span><span class="p">);</span>               <span class="c1">#... with y-axis labeled.</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, to plot the conductances, let's define three new variables,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gNa0</span> <span class="o">=</span> <span class="mi">120</span>
<span class="n">gNa</span>  <span class="o">=</span> <span class="n">gNa0</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">h</span>                 <span class="c1"># Sodium conductance</span>
<span class="n">gK0</span>  <span class="o">=</span> <span class="mi">36</span>
<span class="n">gK</span>   <span class="o">=</span> <span class="n">gK0</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span>                    <span class="c1"># Potassium conductance</span>
<span class="n">gL0</span>  <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">gL</span>   <span class="o">=</span> <span class="n">gL0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">gK</span><span class="p">))</span>   <span class="c1"># Leak conductance</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">
**Q:** Where do these terms come from?
</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, let's plot these conductances,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>  <span class="c1">#Make a second subplot,</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">gNa</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gNa&#39;</span><span class="p">)</span>    <span class="c1">#... and plot the sodium conductance,</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">gK</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gK&#39;</span><span class="p">)</span>     <span class="c1">#... and plot the potassium conductance,</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">gL</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gL&#39;</span><span class="p">)</span>     <span class="c1">#... and plot the leak conductance.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">42</span><span class="p">,</span> <span class="mi">56</span><span class="p">])</span>                  <span class="c1">#... focused on a single spike,</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [ms]&#39;</span><span class="p">)</span>             <span class="c1">#... label the x-axis.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mS/cm^2&#39;</span><span class="p">)</span>               <span class="c1">#... and label the y-axis.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>                       <span class="c1">#... make a legend.</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">
**Q:** How do the conductances evolve during a spike?
</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-5:--At-high-input-current-(I0),-describe-the-dynamics-of-the-currents.">Part 5:  At high input current (<code>I0</code>), describe the dynamics of the <em>currents</em>.<a class="anchor-link" href="#Part-5:--At-high-input-current-(I0),-describe-the-dynamics-of-the-currents."> </a></h2><p>In Part 4, we explored how the three conductances (<code>gNa</code>, <code>gK</code>, <code>gL</code>) evolve
  during a spike.  Let's now visualize how the <em>ionic currents</em> evolve
  during a spike.  To do so, let's stick with the same settings used in
  Part 4 and examine the same simulation result.  Again, we'll focus our plot
  on a single spike.</p>
<p>Now, to plot the <em>current</em>, let's define the new variables,</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gNa0</span> <span class="o">=</span> <span class="mi">120</span>
<span class="n">ENa</span>  <span class="o">=</span> <span class="mi">115</span>
<span class="n">INa</span>  <span class="o">=</span> <span class="n">gNa0</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="n">ENa</span><span class="o">-</span><span class="p">(</span><span class="n">V</span><span class="o">+</span><span class="mi">65</span><span class="p">))</span>    <span class="c1"># Sodium current.</span>
<span class="n">gK0</span>  <span class="o">=</span> <span class="mi">36</span>
<span class="n">EK</span>   <span class="o">=-</span><span class="mi">12</span>
<span class="n">IK</span>   <span class="o">=</span> <span class="n">gK0</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">EK</span><span class="o">-</span><span class="p">(</span><span class="n">V</span><span class="o">+</span><span class="mi">65</span><span class="p">))</span>        <span class="c1"># Potassium current.</span>
<span class="n">gL0</span>  <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">EL</span>   <span class="o">=</span> <span class="mf">10.6</span><span class="p">;</span>
<span class="n">IL</span>   <span class="o">=</span> <span class="n">gL0</span><span class="o">*</span><span class="p">(</span><span class="n">EL</span><span class="o">-</span><span class="p">(</span><span class="n">V</span><span class="o">+</span><span class="mi">65</span><span class="p">))</span>             <span class="c1"># Leak current.</span>

<span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>   <span class="c1"># Make a third subplot,</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">INa</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;INa&#39;</span><span class="p">)</span>   <span class="c1">#... and plot the sodium current,</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">IK</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;IK&#39;</span><span class="p">)</span>    <span class="c1">#... and plot the potassium current,</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;IL&#39;</span><span class="p">)</span>    <span class="c1">#... and plot the leak current.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">42</span><span class="p">,</span> <span class="mi">56</span><span class="p">])</span>                 <span class="c1">#... focus on a single spike,</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [ms]&#39;</span><span class="p">)</span>            <span class="c1">#... label the x-axis.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mA/cm^2&#39;</span><span class="p">)</span>              <span class="c1">#... and label the y-axis.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>                      <span class="c1">#... make a legend.</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">
**Q:** How do the conductances evolve during a spike?
</div>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-block alert-info">
**Q:** You may notice a small, transient decrease in the sodium current `INa` near 47 ms. What causes this?
</div>
</div>
</div>
</div>
</div>

 


    </main>
    